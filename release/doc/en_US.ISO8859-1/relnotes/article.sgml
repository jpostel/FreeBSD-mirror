<!DOCTYPE article PUBLIC "-//FreeBSD//DTD DocBook V4.1-Based Extension//EN" [
<!ENTITY % articles.ent PUBLIC "-//FreeBSD//ENTITIES DocBook FreeBSD Articles Entity Set//EN">
%articles.ent;

<!ENTITY % release PUBLIC "-//FreeBSD//ENTITIES Release Specification//EN">
%release;
]>

<article>
<articleinfo>
  <title>&os; &release.current; Release Notes</title>

  <corpauthor>The &os; Project</corpauthor>

  <pubdate>$FreeBSD$</pubdate>

  <copyright>
    <year>2010</year>
    <holder role="mailto:doc@FreeBSD.org">The &os; Documentation Project</holder>
  </copyright>

  <legalnotice id="trademarks" role="trademarks">
    &tm-attrib.freebsd;
    &tm-attrib.ibm;
    &tm-attrib.ieee;
    &tm-attrib.intel;
    &tm-attrib.sparc;
    &tm-attrib.general;
  </legalnotice>

  <abstract>
    <para>The release notes for &os; &release.current; contain a summary
      of the changes made to the &os; base system on the
      &release.branch; development line.
      This document lists applicable security advisories that were issued since
      the last release, as well as significant changes to the &os;
      kernel and userland.
      Some brief remarks on upgrading are also presented.</para>
  </abstract>
</articleinfo>

<sect1 id="intro">
  <title>Introduction</title>

  <para>This document contains the release notes for &os;
    &release.current;.	It
    describes recently added, changed, or deleted features of &os;.
    It also provides some notes on upgrading
    from previous versions of &os;.</para>

<![ %release.type.current [

  <para>The &release.type; distribution to which these release notes
    apply represents the latest point along the &release.branch; development
    branch since &release.branch; was created.	Information regarding pre-built, binary
    &release.type; distributions along this branch
    can be found at <ulink url="&release.url;"></ulink>.</para>

]]>

<![ %release.type.snapshot [

  <para>The &release.type; distribution to which these release notes
    apply represents a point along the &release.branch; development
    branch between &release.prev; and the future &release.next;.
    Information regarding
    pre-built, binary &release.type; distributions along this branch
    can be found at <ulink url="&release.url;"></ulink>.</para>

]]>

<![ %release.type.release [

  <para>This distribution of &os; &release.current; is a
    &release.type; distribution.  It can be found at <ulink
    url="&release.url;"></ulink> or any of its mirrors.	 More
    information on obtaining this (or other) &release.type;
    distributions of &os; can be found in the <ulink
    url="&url.books.handbook;/mirrors.html"><quote>Obtaining
    &os;</quote> appendix</ulink> to the <ulink
    url="&url.books.handbook;/">&os;
    Handbook</ulink>.</para>

]]>

  <para>All users are encouraged to consult the release errata before
    installing &os;.  The errata document is updated with
    <quote>late-breaking</quote> information discovered late in the
    release cycle or after the release.	 Typically, it contains
    information on known bugs, security advisories, and corrections to
    documentation.  An up-to-date copy of the errata for &os;
    &release.current; can be found on the &os; Web site.</para>

</sect1>

  <sect1 id="new">
    <title>What's New</title>

    <para>This section describes the most user-visible new or changed
      features in &os; since &release.prev;.</para>

    <para>Typical release note items document recent security
      advisories issued after &release.prev;, new drivers or hardware
      support, new commands or options, major bug fixes, or
      contributed software upgrades.  They may also list changes to
      major ports/packages or release engineering practices.  Clearly
      the release notes cannot list every single change made to &os;
      between releases; this document focuses primarily on security
      advisories, user-visible changes, and major architectural
      improvements.</para>

    <sect2 id="security">
      <title>Security Advisories</title>

      <para>Problems described in the following security advisories have
	been fixed.  For more information, consult the individual
	advisories available from
	<ulink url="http://security.FreeBSD.org/"></ulink>.</para>

      <informaltable frame="none" pgwide="0">
	<tgroup cols="3">
	  <colspec colwidth="1*">
	  <colspec colwidth="1*">
	  <colspec colwidth="3*">
	    <thead>
	      <row>
		<entry>Advisory</entry>
		<entry>Date</entry>
		<entry>Topic</entry>
	      </row>
	    </thead>

	    <tbody>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-09:15.ssl.asc"
			      >SA-09:15.ssl</ulink></entry>
		<entry>3&nbsp;Dec&nbsp;2009</entry>
		<entry><para>SSL protocol flaw</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-09:16.rtld.asc"
			      >SA-09:16.rtld</ulink></entry>
		<entry>3&nbsp;Dec&nbsp;2009</entry>
		<entry><para>Improper environment sanitization in &man.rtld.1;</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-09:17.freebsd-update.asc"
			      >SA-09:17.freebsd-update</ulink></entry>
		<entry>3&nbsp;Dec&nbsp;2009</entry>
		<entry><para>Inappropriate directory permissions in &man.freebsd-update.8;</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:01.bind.asc"
			      >SA-10:01.bind</ulink></entry>
		<entry>6&nbsp;Jan&nbsp;2010</entry>
		<entry><para>BIND &man.named.8; cache poisoning with DNSSEC validation</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:02.ntpd.asc"
			      >SA-10:02.ntpd</ulink></entry>
		<entry>6&nbsp;Jan&nbsp;2010</entry>
		<entry><para>ntpd mode 7 denial of service</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:03.zfs.asc"
			      >SA-10:03.zfs</ulink></entry>
		<entry>6&nbsp;Jan&nbsp;2010</entry>
		<entry><para>ZFS ZIL playback with insecure permissions</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:04.jail.asc"
			      >SA-10:04.jail</ulink></entry>
		<entry>27&nbsp;May&nbsp;2010</entry>
		<entry><para>Insufficient environment sanitization in &man.jail.8;</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:05.opie.asc"
			      >SA-10:05.opie</ulink></entry>
		<entry>27&nbsp;May&nbsp;2010</entry>
		<entry><para>OPIE off-by-one stack overflow</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:06.nfsclient.asc"
			      >SA-10:06.nfsclient</ulink></entry>
		<entry>27&nbsp;May&nbsp;2010</entry>
		<entry><para>Unvalidated input in nfsclient</para></entry>
	      </row>
	      <row>
		<entry><ulink url="http://security.freebsd.org/advisories/FreeBSD-SA-10:07.mbuf.asc"
			      >SA-10:07.mbuf</ulink></entry>
		<entry>13&nbsp;July&nbsp;2010</entry>
		<entry><para>Lost mbuf flag resulting in data corruption</para></entry>
	      </row>
	    </tbody>
	</tgroup>
      </informaltable>
    </sect2>

    <sect2 id="kernel">
      <title>Kernel Changes</title>

      <para></para>

      <para>The <command>show mount</command> command in the
	&man.ddb.4; debugger now prints active string mount
	options.</para>

      <para>Two commands to enable/disable read-ahead has been added
	to &man.fcntl.2; system call:</para>

      <itemizedlist>
	<listitem>
	  <para><varname>F_READAHEAD</varname> specifies the amount
	    for sequential access.  The amount is specified in bytes and is
	    rounded up to nearest block size.</para>
	</listitem>

	<listitem>
	  <para><varname>F_RDAHEAD</varname> is a Darwin compatible
	    version that use 128KB as the sequential access
	    size.</para>
	</listitem>
      </itemizedlist>

      <para>Note that the read-ahead amount is also constrainted by
	sysctl variable <varname>vfs.read_max</varname>, which may
	need to be raised in order to better utilize this
	feature.</para>

      <para>The &man.lindev.4; driver has been added.  This is for
	supporting various linux-specific pseudo devices such as
	<filename>/dev/full</filename>.  Note that this is not
	included in <filename>GENERIC</filename> kernel.</para>

      <para>New SDT (Statically Defined Tracing) probes such as ones
	for opencrypto have been added to &os; &man.dtrace.1;
	subsystem.</para>

      <para arch="powerpc">&os; now supports SMP in PowerPC G5
	systems.  Note that SMP support is disabled by default in
	<filename>GENERIC</filename> kernel.</para>

      <para>A bug in the &man.sched.ule.4; scheduler which prevented
	process usage (<literal>%CPU</literal>) from working correctly
	has been fixed.</para>

      <para>The VIMAGE &man.jail.8; virtualization container can work
	with &man.sctp.4; now.  Note that the VIMAGE is not enabled by
	default in <filename>GENERIC</filename> kernel.</para>

      <sect3 id="boot">
	<title>Boot Loader Changes</title>

        <para>A kernel environment variable
	  <varname>vfs.root.mountfrom</varname> now supports
	  multiple elements for root file system in a space-separated
	  list.  Each list element will be tried in order and the
	  first available one will be mounted.</para>

	<para arch="i386">The algorithm the &man.loader.8; uses has
	  been improved to choose a memory range for its heap when
	  using a range above 1MB.  This fixes a symptom that the
	  loader fails to load a kernel.</para>

        <para>The <filename>zfsloader</filename> has been added.  This
	  is a separate &man.zfs.8; enabled loader.  Note that a ZFS
	  bootcode (<filename>zfsboot</filename> or
	  <filename>gptzfsboot</filename>) need to be installed
	  to use this new loader.</para>

        <para>The <filename>zfsboot</filename> and
	  <filename>gptzfsboot</filename> bootcode now fully support
	  64-bit LBAs for disk addresses.  This allows booting from
	  large volumes.</para>

        <para></para>
      </sect3>

      <sect3 id="proc">
	<title>Hardware Support</title>

        <para arch="powerpc">The <filename>adb</filename> driver now
	  supports for interpreting taps on ADB touchpads as a button
	  click.</para>

        <para arch="powerpc">The <filename>apt</filename> driver for
	  the Apple Touchpad present on MacBook has been added to
	  <filename>GENERIC</filename> kernel.</para>

        <para>The &man.uart.4; driver now supports NetMos NM9865
	  family of Serial/Parallel ports.</para>

	<sect4 id="mm">
	  <title>Multimedia Support</title>

          <para></para>
	</sect4>

	<sect4 id="net-if">
	  <title>Network Interface Support</title>

          <para></para>

          <para>The &man.bge.4; driver now supports 5761, 5784, and
	    57780-based devices.</para>

          <para>The &man.cxgb.4; driver has been updated to T3
	    firmware 7.8.0.</para>

          <para>The &man.msk.4; driver now supports Marvell Yukon
	    88E8042, 88E8057 devices and DGE-560SX (Yukon XL).</para>

          <para>The &man.re.4; driver no longer performs an
	    unnecessary interface up/down during getting IP address
	    via DHCP.</para>

          <para>The tsec(4) driver now supports &man.altq.4;.</para>

          <para>The &man.urtw.4; driver has been improved and now
	    supports RTL8187B-based devices.</para>
	</sect4>
      </sect3>

      <sect3 id="net-proto">
	<title>Network Protocols</title>

        <para></para>

        <para>IPcomp (IP Payload Compression Protocol defined in RFC
	  2393) protocol is now enabled by default.  Note that this
	  requires <option>option IPSEC</option> in the kernel
	  configuration file and <filename>GENERIC</filename> kernel
	  does not include it.  This functionality can be disabled by
	  using a sysctl variable
	  <varname>net.inet.ipcomp.ipcomp_enable</varname>.</para>

        <para>For IPv6 sockets in the Linux emulation environment
	  <varname>IPV6_V6ONLY</varname> socket option is unconditionally
          reset regardless of <varname>net.inet6.ip6.v6only</varname> sysctl
	  variable.</para>
      </sect3>

      <sect3 id="disks">
	<title>Disks and Storage</title>

        <para></para>

        <para>The &man.gmirror.8; utility now supports
	  <command>configure <option>-p</option>
	    <replaceable>priority</replaceable></command> command to
	  change the providers priority.</para>

        <para>The balancing mode algorithm <literal>load</literal>
	  used in the &man.gmirror.8; utility has been changed and it
	  is now the default one instead of
	  <literal>split</literal>:</para>

	<itemizedlist>
	  <listitem>
	    <para>Instead of measuring last request execution time for
	      each drive and choosing one with smallest time, use
	      averaged number of requests, running on each drive. This
	      information is more accurate and timely. It allows to
	      distribute load between drives in more even and
	      predictable way.</para>
	  </listitem>

	  <listitem>
	    <para>For each drive track offset of the last submitted
	      request. If new request offset matches previous one or
	      close for some drive, prefer that drive.  It allows to
	      significantly speedup simultaneous sequential reads.</para>
	  </listitem>
	</itemizedlist>

        <para>A new kernel option <option>option ATA_CAM</option> has
	  been added.  This turns &man.ata.4; controller drivers into
	  &man.cam.4; interface modules.  When enabled, this option
	  deprecates all &man.ata.4; peripheral drivers and interfaces
	  such as <filename>ad</filename> and
	  <filename>acd</filename>, and allows &man.cam.4; drivers
	  <filename>ada</filename>, and <filename>cd</filename> and
	  interfaces to be natively used instead.  Note that this is
	  not enabled by default in the <filename>GENERIC</filename>
	  kernel.</para>

        <para>A bug in the &man.ata.4; driver which can lead to
	  interrupt storms and command timeouts has been fixed.</para>

        <para>USB mass storage device support in the &man.ata.4;
	  driver has been removed.  Note that this was not used in
	  <filename>GENERIC</filename> kernel and the &man.umass.4;
	  driver supports such devices for a long time.</para>

        <para>The &man.ahd.4; driver now supports three separated
	  error counters for correctable, uncorrectable, and fatal, in
	  &man.sysctl.8; MIB.</para>

        <para>SATA and PATA support of &os; &man.cam.3; SCSI framework
	  has been improved and it now recognizes more detail device
	  capabilities.  For example, the &man.ahci.4; and
	  &man.siis.4; driver now reports maximum tag number to the
	  framework to optimize the NCQ handling.</para>
      </sect3>

      <sect3 id="fs">
	<title>File Systems</title>

        <para></para>
      </sect3>
    </sect2>

    <sect2 id="userland">
      <title>Userland Changes</title>

      <para>A bug in &man.bsnmpd.1; program which leads to high CPU
	consumption on a loaded system has been fixed.</para>

      <para>A bug in &man.bzip2.1; utility which prevented it from
	working with multi-session bzip2 files.</para>

      <para>A bug in &man.ee.1; utility which can crash the
	program has been fixed.</para>

      <para>A bug in &man.factor.6; utility which leads to performance
	degradation has been fixed.</para>

      <para>A bug in &man.fetch.1; utility which incorrectly evaluates
	a variable <varname>NO_PROXY</varname> has been fixed.</para>

      <para>The &man.ifconfig.8; utility now supports manipulation of
	NDP flags handled by &man.ndp.8;.</para>

      <para>The &man.ntpd.8; program no longer tries to bind to an
	IPv6 anycast address.</para>

      <para>The &man.unifdef.1; utility has been updated to version
	1.188.  It now supports a new <option>-B</option> flag to
	compress blank lines around a deleted section to prevent blank
	lines around paragraphs of code from getting doubled.</para>

      <para>A new errno <varname>ENOTCAPABLE</varname> has been added.
	This is to be returned when a process requests an operation on
	a file descriptor that is not authorized by the descriptor's
	capability flags.</para>

      <sect3 id="rc-scripts">
        <title><filename>/etc/rc.d</filename> Scripts</title>

        <para></para>

        <para>A new <filename>rc.d</filename> script
	  <filename>static_arp</filename> has been added.  This allows
	  the administrator to statically define mappings of MAC
	  address to IPv4 at boot time.  See also the &man.rc.conf.5;
	  manual page for more details.</para>
      </sect3>
    </sect2>

    <sect2 id="contrib">
      <title>Contributed Software</title>

      <para></para>

      <para><application>ISC BIND</application> has been updated to
	version 9.6.1-P2.</para>
<!--

      <para role="8.0">The <application>ACPI-CA</application> has been
	updated to 20090521.</para>

      <para role="8.0">The <application>ee</application> (easy editor) has
	been updated to 1.5.0.	This version is now licensed under a
	2-clause BSD license, instead of the Artistic license.</para>

      <para role="8.0">The <application>hostapd</application> has been updated to
	version 0.6.8 + radius ACL support.</para>

      <para role="8.0">The <application>less</application> has been updated to
	version v436.</para>

      <para role="8.0">The <filename>libarchive</filename> library has
	been updated to version 2.7.0.</para>

      <para role="8.0">The <filename>libexpat</filename> library has
	been updated from version 1.95.5 to version 2.0.1.</para>

      <para role="8.0">The <filename>ncurses</filename> library has been updated
	to version 5.7-20081102.</para>

      <para role="8.0"><application>OpenBSM</application> 1.1 from
	Trusted BSD Project has been merged.</para>

      <para role="8.0"><application>TCPDUMP</application> has been
	updated to 4.0.0.</para>

      <para role="8.0">The timezone database has been updated
	to the <application>tzdata2009f</application> release.</para>

      <para role="8.0"><application>wpa_supplicant</application> has been updated to
	version 0.6.8</para>

      <para role="8.0">The <application>ZFS</application> file system
	has been updated from version 6 to version 13.</para>

      <para role="7.1">The <application>am-utils</application> has been updated from
	version 6.0.10p1 to version 6.1.5.</para>

      <para role="7.1">The <application>awk</application> has been updated from 1 May
	2007 release to the 23 October 2007 release.</para>

      <para role="7.1">The <application>bzip2</application> has been updated from
	version 1.0.4 to version 1.0.5.</para>

      <para role="7.1">The <application>CVS</application> has been updated to
	version 1.11.22.1.</para>

      <para role="7.1"><application>NTP</application> has been updated to version
	4.2.4p5.</para>

      <para role="7.1"><application>OpenPAM</application> has been updated from the
	Figwort release to the Hydrangea release.</para>

      <para role="7.1"><application>OpenSSH</application> has been updated from
	version 4.5p1 to version 5.1p1.</para>

      <para role="7.1">The &man.resolver.3; library has been updated to
	one of <application>ISC BIND</application> 9.4.3.</para>

      <para role="7.1"><application>sendmail</application> has been updated from
	version 8.14.2 to version 8.14.4.</para>
-->
    </sect2>

    <sect2 id="ports">
      <title>Ports/Packages Collection Infrastructure</title>

      <para></para>
    </sect2>

    <sect2 id="releng">
      <title>Release Engineering and Integration</title>

      <para>The supported version of
	the <application>GNOME</application> desktop environment
	(<filename role="package">x11/gnome2</filename>) has been
	updated to 2.28.2.</para>

      <para>The supported version of
	the <application>KDE</application> desktop environment
	(<filename role="package">x11/kde4</filename>) has been
	updated to 4.4.3.</para>
    </sect2>
  </sect1>

  <sect1 id="upgrade">
    <title>Upgrading from previous releases of &os;</title>

    <para arch="amd64,i386">Upgrades between RELEASE versions (and
      snapshots of the various security branches) are supported using
      the &man.freebsd-update.8; utility.  The binary upgrade
      procedure will update unmodified userland utilities, as well as
      unmodified GENERIC kernel distributed as a part of an
      official &os; release.  The &man.freebsd-update.8; utility
      requires that the host being upgraded has Internet
      connectivity.</para>

    <para>An older form of binary upgrade is supported through the
      <command>Upgrade</command> option from the main
      &man.sysinstall.8; menu on CDROM distribution media.  This type
      of binary upgrade may be useful on non-&arch.i386;,
      non-&arch.amd64; machines or on systems with no Internet
      connectivity.</para>

    <para>Source-based upgrades (those based on recompiling the &os;
      base system from source code) from previous versions are
      supported, according to the instructions in
      <filename>/usr/src/UPDATING</filename>.</para>

    <important>
      <para>Upgrading &os; should, of course, only be attempted after
	backing up <emphasis>all</emphasis> data and configuration
	files.</para>
    </important>
  </sect1>
</article>
